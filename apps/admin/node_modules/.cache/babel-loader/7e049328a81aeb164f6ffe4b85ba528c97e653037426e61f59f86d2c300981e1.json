{"ast":null,"code":"import { resolveComponent as _resolveComponent, createVNode as _createVNode, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, withCtx as _withCtx, createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode } from \"vue\";\nconst _hoisted_1 = {\n  key: 0\n};\nconst _hoisted_2 = {\n  class: \"right-btn-container\"\n};\nconst _hoisted_3 = {\n  key: 1,\n  class: \"loading-container\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_el_tree = _resolveComponent(\"el-tree\");\n  const _component_el_button = _resolveComponent(\"el-button\");\n  const _component_Loading = _resolveComponent(\"Loading\");\n  const _component_el_icon = _resolveComponent(\"el-icon\");\n  const _component_el_dialog = _resolveComponent(\"el-dialog\");\n  return _openBlock(), _createElementBlock(\"div\", null, [_createVNode(_component_el_dialog, {\n    fullscreen: $setup.getters.isMobile,\n    modelValue: $setup.isShow,\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $setup.isShow = $event),\n    title: _ctx.$t('AssignPerm.index.017835-0', [$setup.props.roleInfo.name || '角色']),\n    onClosed: $setup.resetInfo\n  }, {\n    default: _withCtx(() => [!$setup.isLoading ? (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createVNode(_component_el_tree, {\n      \"check-strictly\": true,\n      ref: \"elTreeRef\",\n      data: $setup.permList,\n      \"show-checkbox\": \"\",\n      \"node-key\": \"id\",\n      \"highlight-current\": \"\",\n      props: $setup.elTreeProps,\n      \"default-checked-keys\": $setup.defaultCheckedIds,\n      \"default-expanded-keys\": $setup.defaultCheckedIds\n    }, null, 8 /* PROPS */, [\"data\", \"default-checked-keys\", \"default-expanded-keys\"]), _createElementVNode(\"div\", _hoisted_2, [_createVNode(_component_el_button, {\n      type: \"primary\",\n      onClick: $setup.onAssignPerm\n    }, {\n      default: _withCtx(() => [_createTextVNode(_toDisplayString(_ctx.$t('AssignPerm.index.017835-1')), 1 /* TEXT */)]),\n      _: 1 /* STABLE */\n    })])])) : (_openBlock(), _createElementBlock(\"div\", _hoisted_3, [_createVNode(_component_el_icon, {\n      class: \"is-loading\",\n      size: \"20\"\n    }, {\n      default: _withCtx(() => [_createVNode(_component_Loading)]),\n      _: 1 /* STABLE */\n    })]))]),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"fullscreen\", \"modelValue\", \"title\"])]);\n}","map":{"version":3,"names":["key","class","_createElementBlock","_createVNode","_component_el_dialog","fullscreen","$setup","getters","isMobile","modelValue","isShow","_cache","$event","title","_ctx","$t","props","roleInfo","name","onClosed","resetInfo","default","_withCtx","isLoading","_hoisted_1","_component_el_tree","ref","data","permList","elTreeProps","defaultCheckedIds","_createElementVNode","_hoisted_2","_component_el_button","type","onClick","onAssignPerm","_createTextVNode","_toDisplayString","_","_hoisted_3","_component_el_icon","size","_component_Loading"],"sources":["D:\\myproject\\毕业设计\\pet-mall\\apps\\admin\\src\\views\\Acl\\Role\\components\\AssignPerm\\index.vue"],"sourcesContent":["<template>\r\n  <div>\r\n    <el-dialog\r\n      :fullscreen=\"getters.isMobile\"\r\n      v-model=\"isShow\"\r\n      :title=\"$t('AssignPerm.index.017835-0', [props.roleInfo.name || '角色'])\"\r\n      @closed=\"resetInfo\"\r\n    >\r\n      <div v-if=\"!isLoading\">\r\n        <el-tree\r\n          :check-strictly=\"true\"\r\n          ref=\"elTreeRef\"\r\n          :data=\"permList\"\r\n          show-checkbox\r\n          node-key=\"id\"\r\n          highlight-current\r\n          :props=\"elTreeProps\"\r\n          :default-checked-keys=\"defaultCheckedIds\"\r\n          :default-expanded-keys=\"defaultCheckedIds\"\r\n        />\r\n        <div class=\"right-btn-container\">\r\n          <el-button type=\"primary\" @click=\"onAssignPerm\">{{ $t('AssignPerm.index.017835-1') }}</el-button>\r\n        </div>\r\n      </div>\r\n      <div v-else class=\"loading-container\">\r\n        <el-icon class=\"is-loading\" size=\"20\"><Loading /></el-icon>\r\n      </div>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { getRolePermission, assignPermission } from '@/api/role-manage'\r\nimport { ref, defineProps, computed, defineEmits, watch } from 'vue'\r\nimport { useStore } from 'vuex'\r\nconst { getters } = useStore()\r\nconst permList = ref([])\r\nconst defaultCheckedIds = ref([])\r\nconst props = defineProps({\r\n  modelValue: {\r\n    required: true,\r\n    type: Boolean\r\n  },\r\n  roleInfo: {\r\n    required: true,\r\n    type: Object\r\n  }\r\n})\r\n\r\nconst isShow = computed({\r\n  get() {\r\n    return props.modelValue\r\n  },\r\n  set(val) {\r\n    emit('update:modelValue', val)\r\n  }\r\n})\r\nconst emit = defineEmits(['update:modelValue', 'complete'])\r\nconst elTreeProps = {\r\n  children: 'children',\r\n  label: 'name'\r\n}\r\nconst elTreeRef = ref()\r\nconst isLoading = ref(true)\r\n\r\nwatch(props, async (props) => {\r\n  if (props.modelValue) {\r\n    isLoading.value = true\r\n    await getPermListInfo(props.roleInfo.id)\r\n    isLoading.value = false\r\n  }\r\n})\r\n\r\n/**\r\n * 获取角色的权限\r\n * @param {*} id\r\n */\r\nasync function getPermListInfo(id) {\r\n  const info = await getRolePermission(id)\r\n  defaultCheckedIds.value = info.selected\r\n  permList.value = info.list\r\n}\r\n/**\r\n * 分配权限\r\n */\r\nasync function onAssignPerm() {\r\n  const list = elTreeRef.value.getCheckedKeys()\r\n  assignPermission({ roleId: props.roleInfo.id, permissionIdList: list }).then(() => {\r\n    isShow.value = false\r\n    emit('complete')\r\n  })\r\n}\r\nfunction resetInfo() {\r\n  permList.value = []\r\n  defaultCheckedIds.value = []\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.right-btn-container {\r\n  display: flex;\r\n  justify-content: right;\r\n}\r\n.loading-container {\r\n  display: flex;\r\n  justify-content: center;\r\n}\r\n</style>\r\n"],"mappings":";;EAAAA,GAAA;AAAA;;EAoBaC,KAAK,EAAC;AAAqB;;EApBxCD,GAAA;EAwBkBC,KAAK,EAAC;;;;;;;;uBAvBtBC,mBAAA,CA2BM,cA1BJC,YAAA,CAyBYC,oBAAA;IAxBTC,UAAU,EAAEC,MAAA,CAAAC,OAAO,CAACC,QAAQ;IAHnCC,UAAA,EAIeH,MAAA,CAAAI,MAAM;IAJrB,uBAAAC,MAAA,QAAAA,MAAA,MAAAC,MAAA,IAIeN,MAAA,CAAAI,MAAM,GAAAE,MAAA;IACdC,KAAK,EAAEC,IAAA,CAAAC,EAAE,+BAA+BT,MAAA,CAAAU,KAAK,CAACC,QAAQ,CAACC,IAAI;IAC3DC,QAAM,EAAEb,MAAA,CAAAc;;IANfC,OAAA,EAAAC,QAAA,CAQM,MAeM,C,CAfMhB,MAAA,CAAAiB,SAAS,I,cAArBrB,mBAAA,CAeM,OAvBZsB,UAAA,GASQrB,YAAA,CAUEsB,kBAAA;MATC,gBAAc,EAAE,IAAI;MACrBC,GAAG,EAAC,WAAW;MACdC,IAAI,EAAErB,MAAA,CAAAsB,QAAQ;MACf,eAAa,EAAb,EAAa;MACb,UAAQ,EAAC,IAAI;MACb,mBAAiB,EAAjB,EAAiB;MAChBZ,KAAK,EAAEV,MAAA,CAAAuB,WAAW;MAClB,sBAAoB,EAAEvB,MAAA,CAAAwB,iBAAiB;MACvC,uBAAqB,EAAExB,MAAA,CAAAwB;wFAE1BC,mBAAA,CAEM,OAFNC,UAEM,GADJ7B,YAAA,CAAiG8B,oBAAA;MAAtFC,IAAI,EAAC,SAAS;MAAEC,OAAK,EAAE7B,MAAA,CAAA8B;;MArB5Cf,OAAA,EAAAC,QAAA,CAqB0D,MAAqC,CArB/Fe,gBAAA,CAAAC,gBAAA,CAqB6DxB,IAAA,CAAAC,EAAE,8C;MArB/DwB,CAAA;6BAwBMrC,mBAAA,CAEM,OAFNsC,UAEM,GADJrC,YAAA,CAA2DsC,kBAAA;MAAlDxC,KAAK,EAAC,YAAY;MAACyC,IAAI,EAAC;;MAzBzCrB,OAAA,EAAAC,QAAA,CAyB8C,MAAW,CAAXnB,YAAA,CAAWwC,kBAAA,E;MAzBzDJ,CAAA;;IAAAA,CAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}