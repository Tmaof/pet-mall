{"ast":null,"code":"import { onMounted, ref } from 'vue';\nimport { getUserList, deleteUserById } from '@/api/user-manage';\nimport AddUserDialog from './components/AddUserDialog';\nimport exportExcel from './hooks/exportExcel';\nimport AssignRoles from './components/AssignRoles';\nexport default {\n  __name: 'index',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const userListInfo = ref([]);\n    const page = ref(1);\n    const size = ref(5);\n    const pageSizes = [5, 10, 20, 30, 70, 100];\n    const isShowDiaLog = ref(false);\n    const exportExLoading = ref(false);\n    const currentUserId = ref();\n    const isShowAssignRoles = ref(false);\n    function onCurrentChange(newPage) {\n      page.value = newPage;\n      getUserListInfo();\n    }\n    function onSizeChange(newSize) {\n      size.value = newSize;\n      getUserListInfo();\n    }\n    /**\r\n     * 分页获取员工列表\r\n     */\n    async function getUserListInfo() {\n      userListInfo.value = await getUserList(page.value, size.value);\n    }\n    /**\r\n     * 删除员工\r\n     */\n    async function deleteUser(id) {\n      await deleteUserById(id);\n      getUserListInfo();\n    }\n    /**\r\n     * excel导出\r\n     */\n    async function exportExcelFile() {\n      exportExLoading.value = true;\n      await exportExcel();\n      exportExLoading.value = false;\n    }\n    /**\r\n     * 分配角色\r\n     */\n    function assignRoles(id) {\n      isShowAssignRoles.value = true;\n      currentUserId.value = id;\n    }\n    onMounted(() => {\n      getUserListInfo();\n    });\n    const __returned__ = {\n      userListInfo,\n      page,\n      size,\n      pageSizes,\n      isShowDiaLog,\n      exportExLoading,\n      currentUserId,\n      isShowAssignRoles,\n      onCurrentChange,\n      onSizeChange,\n      getUserListInfo,\n      deleteUser,\n      exportExcelFile,\n      assignRoles,\n      onMounted,\n      ref,\n      get getUserList() {\n        return getUserList;\n      },\n      get deleteUserById() {\n        return deleteUserById;\n      },\n      get AddUserDialog() {\n        return AddUserDialog;\n      },\n      get exportExcel() {\n        return exportExcel;\n      },\n      get AssignRoles() {\n        return AssignRoles;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["onMounted","ref","getUserList","deleteUserById","AddUserDialog","exportExcel","AssignRoles","userListInfo","page","size","pageSizes","isShowDiaLog","exportExLoading","currentUserId","isShowAssignRoles","onCurrentChange","newPage","value","getUserListInfo","onSizeChange","newSize","deleteUser","id","exportExcelFile","assignRoles"],"sources":["D:/myproject/毕业设计/pet-mall/apps/admin/src/views/Acl/User/index.vue"],"sourcesContent":["<template>\r\n  <div class=\"user-list-container\">\r\n    <el-card shadow=\"never\">\r\n      <!-- 头部 -->\r\n      <div class=\"head\">\r\n        <el-button\r\n          type=\"primary\"\r\n          @click=\"isShowDiaLog = true\"\r\n          v-permission=\"'excel-import'\"\r\n          >{{ $t('User.index.017834-0') }}</el-button\r\n        >\r\n        <el-button\r\n          type=\"success\"\r\n          @click=\"exportExcelFile\"\r\n          loading-icon=\"Loading\"\r\n          :loading=\"exportExLoading\"\r\n          >{{ $t('User.index.017834-1') }}</el-button\r\n        >\r\n      </div>\r\n      <!-- 表格 -->\r\n      <el-table :data=\"userListInfo.list || []\" border>\r\n        <el-table-column type=\"index\" :label=\"$t('User.index.017834-2')\"></el-table-column>\r\n        <el-table-column :label=\"$t('User.index.017834-3')\" >\r\n          <template v-slot=\"{ row }\">\r\n            <el-avatar fit=\"contain\" :src=\"row.avatar\">\r\n              <SvgIcon icon=\"my-user\"></SvgIcon>\r\n            </el-avatar>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column :label=\"$t('User.index.017834-4')\" >\r\n          <template v-slot=\"{ row }\">\r\n            {{ row.username }}\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column :label=\"$t('User.index.017834-5')\" >\r\n          <template v-slot=\"{ row }\">\r\n            <el-tag v-for=\"item of row.role\" :key=\"item.id\">{{\r\n              item.name\r\n            }}</el-tag>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column :label=\"$t('User.index.017834-6')\" >\r\n          <template v-slot=\"{ row }\">\r\n            {{ $filters.dateFilter(row.openTime) }}\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column :label=\"$t('User.index.017834-7')\" >\r\n          <template #default=\"{ row }\">\r\n            <el-button\r\n              icon=\"Tools\"\r\n              type=\"primary\"\r\n              @click=\"assignRoles(row.id)\"\r\n              v-permission=\"'assign-role'\"\r\n            ></el-button>\r\n            <el-popconfirm @confirm=\"deleteUser(row.id)\" :title=\"$t('User.index.017834-8')\">\r\n              <template #reference>\r\n                <el-button\r\n                  icon=\"DeleteFilled\"\r\n                  type=\"danger\"\r\n                  v-permission=\"'delete-user'\"\r\n                ></el-button>\r\n              </template>\r\n            </el-popconfirm>\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n      <div class=\"pagination-container\">\r\n        <el-pagination\r\n          :total=\"userListInfo.total || 0\"\r\n          :page-size=\"size\"\r\n          :page-sizes=\"pageSizes\"\r\n          v-model=\"page\"\r\n          layout=\"total,sizes, prev, pager, next, jumper\"\r\n          @current-change=\"onCurrentChange\"\r\n          @size-change=\"onSizeChange\"\r\n        />\r\n      </div>\r\n      <!-- 对话框组件 -->\r\n      <AddUserDialog\r\n        v-model=\"isShowDiaLog\"\r\n        @complete=\"getUserListInfo()\"\r\n      ></AddUserDialog>\r\n      <AssignRoles\r\n        v-model=\"isShowAssignRoles\"\r\n        :userId=\"currentUserId\"\r\n        @complete=\"getUserListInfo()\"\r\n      ></AssignRoles>\r\n    </el-card>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { onMounted, ref } from 'vue'\r\nimport { getUserList, deleteUserById } from '@/api/user-manage'\r\nimport AddUserDialog from './components/AddUserDialog'\r\nimport exportExcel from './hooks/exportExcel'\r\nimport AssignRoles from './components/AssignRoles'\r\nconst userListInfo = ref([])\r\nconst page = ref(1)\r\nconst size = ref(5)\r\nconst pageSizes = [5, 10, 20, 30, 70, 100]\r\nconst isShowDiaLog = ref(false)\r\nconst exportExLoading = ref(false)\r\nconst currentUserId = ref()\r\nconst isShowAssignRoles = ref(false)\r\nfunction onCurrentChange(newPage) {\r\n  page.value = newPage\r\n  getUserListInfo()\r\n}\r\nfunction onSizeChange(newSize) {\r\n  size.value = newSize\r\n  getUserListInfo()\r\n}\r\n/**\r\n * 分页获取员工列表\r\n */\r\nasync function getUserListInfo() {\r\n  userListInfo.value = await getUserList(page.value, size.value)\r\n}\r\n/**\r\n * 删除员工\r\n */\r\nasync function deleteUser(id) {\r\n  await deleteUserById(id)\r\n  getUserListInfo()\r\n}\r\n/**\r\n * excel导出\r\n */\r\nasync function exportExcelFile() {\r\n  exportExLoading.value = true\r\n  await exportExcel()\r\n  exportExLoading.value = false\r\n}\r\n/**\r\n * 分配角色\r\n */\r\nfunction assignRoles(id) {\r\n  isShowAssignRoles.value = true\r\n  currentUserId.value = id\r\n}\r\nonMounted(() => {\r\n  getUserListInfo()\r\n})\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.user-list-container {\r\n  .head {\r\n    margin-bottom: 10px;\r\n  }\r\n  .pagination-container {\r\n    display: flex;\r\n    justify-content: center;\r\n    margin-top: 10px;\r\n    :deep(.el-pagination) {\r\n      overflow-x: auto;\r\n    }\r\n  }\r\n\r\n  :deep(.el-tag) {\r\n    margin: 5px;\r\n  }\r\n}\r\n</style>\r\n"],"mappings":"AA4FA,SAASA,SAAS,EAAEC,GAAG,QAAQ,KAAK;AACpC,SAASC,WAAW,EAAEC,cAAc,QAAQ,mBAAmB;AAC/D,OAAOC,aAAa,MAAM,4BAA4B;AACtD,OAAOC,WAAW,MAAM,qBAAqB;AAC7C,OAAOC,WAAW,MAAM,0BAA0B;;;;;;;IAClD,MAAMC,YAAY,GAAGN,GAAG,CAAC,EAAE,CAAC;IAC5B,MAAMO,IAAI,GAAGP,GAAG,CAAC,CAAC,CAAC;IACnB,MAAMQ,IAAI,GAAGR,GAAG,CAAC,CAAC,CAAC;IACnB,MAAMS,SAAS,GAAG,CAAC,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,CAAC;IAC1C,MAAMC,YAAY,GAAGV,GAAG,CAAC,KAAK,CAAC;IAC/B,MAAMW,eAAe,GAAGX,GAAG,CAAC,KAAK,CAAC;IAClC,MAAMY,aAAa,GAAGZ,GAAG,CAAC,CAAC;IAC3B,MAAMa,iBAAiB,GAAGb,GAAG,CAAC,KAAK,CAAC;IACpC,SAASc,eAAeA,CAACC,OAAO,EAAE;MAChCR,IAAI,CAACS,KAAK,GAAGD,OAAO;MACpBE,eAAe,CAAC,CAAC;IACnB;IACA,SAASC,YAAYA,CAACC,OAAO,EAAE;MAC7BX,IAAI,CAACQ,KAAK,GAAGG,OAAO;MACpBF,eAAe,CAAC,CAAC;IACnB;IACA;AACA;AACA;IACA,eAAeA,eAAeA,CAAA,EAAG;MAC/BX,YAAY,CAACU,KAAK,GAAG,MAAMf,WAAW,CAACM,IAAI,CAACS,KAAK,EAAER,IAAI,CAACQ,KAAK,CAAC;IAChE;IACA;AACA;AACA;IACA,eAAeI,UAAUA,CAACC,EAAE,EAAE;MAC5B,MAAMnB,cAAc,CAACmB,EAAE,CAAC;MACxBJ,eAAe,CAAC,CAAC;IACnB;IACA;AACA;AACA;IACA,eAAeK,eAAeA,CAAA,EAAG;MAC/BX,eAAe,CAACK,KAAK,GAAG,IAAI;MAC5B,MAAMZ,WAAW,CAAC,CAAC;MACnBO,eAAe,CAACK,KAAK,GAAG,KAAK;IAC/B;IACA;AACA;AACA;IACA,SAASO,WAAWA,CAACF,EAAE,EAAE;MACvBR,iBAAiB,CAACG,KAAK,GAAG,IAAI;MAC9BJ,aAAa,CAACI,KAAK,GAAGK,EAAE;IAC1B;IACAtB,SAAS,CAAC,MAAM;MACdkB,eAAe,CAAC,CAAC;IACnB,CAAC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}