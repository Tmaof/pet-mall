{"ast":null,"code":"import { createCommentVNode as _createCommentVNode, createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, resolveComponent as _resolveComponent, createVNode as _createVNode, toDisplayString as _toDisplayString, withCtx as _withCtx, createBlock as _createBlock, createTextVNode as _createTextVNode, resolveDirective as _resolveDirective, withDirectives as _withDirectives } from \"vue\";\nconst _hoisted_1 = {\n  class: \"user-log-container\"\n};\nconst _hoisted_2 = {\n  class: \"search-section\"\n};\nconst _hoisted_3 = {\n  class: \"user-option\"\n};\nconst _hoisted_4 = {\n  class: \"user-id\"\n};\nconst _hoisted_5 = {\n  class: \"delete-section\"\n};\nconst _hoisted_6 = {\n  class: \"delete-form\"\n};\nconst _hoisted_7 = {\n  class: \"user-info\"\n};\nconst _hoisted_8 = {\n  class: \"pagination\"\n};\nconst _hoisted_9 = {\n  class: \"user-info\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_el_avatar = _resolveComponent(\"el-avatar\");\n  const _component_el_option = _resolveComponent(\"el-option\");\n  const _component_el_select = _resolveComponent(\"el-select\");\n  const _component_el_form_item = _resolveComponent(\"el-form-item\");\n  const _component_el_date_picker = _resolveComponent(\"el-date-picker\");\n  const _component_el_button = _resolveComponent(\"el-button\");\n  const _component_el_form = _resolveComponent(\"el-form\");\n  const _component_el_table_column = _resolveComponent(\"el-table-column\");\n  const _component_el_table = _resolveComponent(\"el-table\");\n  const _component_el_pagination = _resolveComponent(\"el-pagination\");\n  const _component_el_card = _resolveComponent(\"el-card\");\n  const _component_el_descriptions_item = _resolveComponent(\"el-descriptions-item\");\n  const _component_el_descriptions = _resolveComponent(\"el-descriptions\");\n  const _component_el_dialog = _resolveComponent(\"el-dialog\");\n  const _directive_permission = _resolveDirective(\"permission\");\n  const _directive_loading = _resolveDirective(\"loading\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createVNode(_component_el_card, {\n    shadow: \"never\"\n  }, {\n    default: _withCtx(() => [_createCommentVNode(\" 查询部分 \"), _createElementVNode(\"div\", _hoisted_2, [_cache[7] || (_cache[7] = _createElementVNode(\"h3\", {\n      class: \"section-title\"\n    }, \"查询条件\", -1 /* HOISTED */)), _createVNode(_component_el_form, {\n      inline: false,\n      model: $setup.searchForm\n    }, {\n      default: _withCtx(() => [_createVNode(_component_el_form_item, {\n        label: \"用户\"\n      }, {\n        default: _withCtx(() => [_createVNode(_component_el_select, {\n          modelValue: $setup.searchForm.userId,\n          \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $setup.searchForm.userId = $event),\n          placeholder: \"请选择用户\",\n          clearable: \"\",\n          filterable: \"\",\n          \"filter-method\": $setup.filterUsers,\n          remote: \"\",\n          \"reserve-keyword\": \"\"\n        }, {\n          default: _withCtx(() => [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.filteredUserList, user => {\n            return _openBlock(), _createBlock(_component_el_option, {\n              key: user.id,\n              label: user.username,\n              value: user.id\n            }, {\n              default: _withCtx(() => [_createElementVNode(\"div\", _hoisted_3, [_createVNode(_component_el_avatar, {\n                size: 24,\n                src: user.avatar\n              }, null, 8 /* PROPS */, [\"src\"]), _createElementVNode(\"span\", null, _toDisplayString(user.username), 1 /* TEXT */), _createElementVNode(\"span\", _hoisted_4, \"(ID: \" + _toDisplayString(user.id) + \")\", 1 /* TEXT */)])]),\n              _: 2 /* DYNAMIC */\n            }, 1032 /* PROPS, DYNAMIC_SLOTS */, [\"label\", \"value\"]);\n          }), 128 /* KEYED_FRAGMENT */))]),\n          _: 1 /* STABLE */\n        }, 8 /* PROPS */, [\"modelValue\"])]),\n        _: 1 /* STABLE */\n      }), _createVNode(_component_el_form_item, {\n        label: \"查询时间\"\n      }, {\n        default: _withCtx(() => [_createVNode(_component_el_date_picker, {\n          style: {\n            \"max-width\": \"320px\"\n          },\n          modelValue: $setup.searchForm.timeRange,\n          \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => $setup.searchForm.timeRange = $event),\n          type: \"datetimerange\",\n          \"range-separator\": \"至\",\n          \"start-placeholder\": \"开始时间\",\n          \"end-placeholder\": \"结束时间\",\n          format: \"YYYY-MM-DD HH:mm:ss\",\n          \"value-format\": \"YYYY-MM-DD HH:mm:ss\"\n        }, null, 8 /* PROPS */, [\"modelValue\"])]),\n        _: 1 /* STABLE */\n      }), _createVNode(_component_el_form_item, null, {\n        default: _withCtx(() => [_createVNode(_component_el_button, {\n          type: \"primary\",\n          onClick: $setup.handleSearch\n        }, {\n          default: _withCtx(() => _cache[5] || (_cache[5] = [_createTextVNode(\"查询\")])),\n          _: 1 /* STABLE */\n        }), _createVNode(_component_el_button, {\n          onClick: $setup.handleReset\n        }, {\n          default: _withCtx(() => _cache[6] || (_cache[6] = [_createTextVNode(\"重置\")])),\n          _: 1 /* STABLE */\n        })]),\n        _: 1 /* STABLE */\n      })]),\n      _: 1 /* STABLE */\n    }, 8 /* PROPS */, [\"model\"])]), _createCommentVNode(\" 删除部分 \"), _createElementVNode(\"div\", _hoisted_5, [_cache[9] || (_cache[9] = _createElementVNode(\"h3\", {\n      class: \"section-title\"\n    }, \"批量删除\", -1 /* HOISTED */)), _createElementVNode(\"div\", _hoisted_6, [_createVNode(_component_el_date_picker, {\n      modelValue: $setup.deleteTimeRange,\n      \"onUpdate:modelValue\": _cache[2] || (_cache[2] = $event => $setup.deleteTimeRange = $event),\n      type: \"datetimerange\",\n      \"range-separator\": \"至\",\n      \"start-placeholder\": \"删除开始时间\",\n      \"end-placeholder\": \"删除结束时间\",\n      format: \"YYYY-MM-DD HH:mm:ss\",\n      \"value-format\": \"YYYY-MM-DD HH:mm:ss\",\n      style: {\n        \"max-width\": \"320px\"\n      }\n    }, null, 8 /* PROPS */, [\"modelValue\"]), _withDirectives((_openBlock(), _createBlock(_component_el_button, {\n      type: \"danger\",\n      onClick: $setup.handleDelete\n    }, {\n      default: _withCtx(() => _cache[8] || (_cache[8] = [_createTextVNode(\"删除选中时间段日志\")])),\n      _: 1 /* STABLE */\n    })), [[_directive_permission, 'delete-user-log']])])]), _withDirectives((_openBlock(), _createBlock(_component_el_table, {\n      data: $setup.logList,\n      border: \"\",\n      style: {\n        \"width\": \"100%\"\n      },\n      onSortChange: $setup.handleSortChange,\n      \"default-sort\": {\n        prop: 'time',\n        order: 'descending'\n      }\n    }, {\n      default: _withCtx(() => [_createVNode(_component_el_table_column, {\n        prop: \"id\",\n        label: \"ID\",\n        width: \"80\"\n      }), _createVNode(_component_el_table_column, {\n        label: \"用户信息\",\n        width: \"200\"\n      }, {\n        default: _withCtx(({\n          row\n        }) => [_createElementVNode(\"div\", _hoisted_7, [_createVNode(_component_el_avatar, {\n          size: 32,\n          src: row.user?.avatar\n        }, null, 8 /* PROPS */, [\"src\"]), _createElementVNode(\"span\", null, _toDisplayString(row.user?.username) + \" (ID: \" + _toDisplayString(row.user?.id) + \")\", 1 /* TEXT */)])]),\n        _: 1 /* STABLE */\n      }), _createVNode(_component_el_table_column, {\n        prop: \"path\",\n        label: \"请求路径\",\n        \"show-overflow-tooltip\": \"\"\n      }), _createVNode(_component_el_table_column, {\n        prop: \"methods\",\n        label: \"请求方法\",\n        width: \"100\"\n      }), _createVNode(_component_el_table_column, {\n        prop: \"ip\",\n        label: \"IP地址\",\n        width: \"150\"\n      }), _createVNode(_component_el_table_column, {\n        prop: \"time\",\n        label: \"请求时间\",\n        width: \"180\",\n        sortable: \"custom\"\n      }, {\n        default: _withCtx(({\n          row\n        }) => [_createTextVNode(_toDisplayString($setup.formatDateTime(row.time)), 1 /* TEXT */)]),\n        _: 1 /* STABLE */\n      }), _createVNode(_component_el_table_column, {\n        prop: \"handeTime\",\n        label: \"处理时长(ms)\",\n        width: \"120\"\n      }), _createVNode(_component_el_table_column, {\n        label: \"详情\",\n        width: \"80\",\n        fixed: \"right\"\n      }, {\n        default: _withCtx(scope => [_createVNode(_component_el_button, {\n          link: \"\",\n          type: \"primary\",\n          onClick: $event => $setup.showDetail(scope.row)\n        }, {\n          default: _withCtx(() => _cache[10] || (_cache[10] = [_createTextVNode(\"查看\")])),\n          _: 2 /* DYNAMIC */\n        }, 1032 /* PROPS, DYNAMIC_SLOTS */, [\"onClick\"])]),\n        _: 1 /* STABLE */\n      })]),\n      _: 1 /* STABLE */\n    }, 8 /* PROPS */, [\"data\"])), [[_directive_loading, $setup.loading]]), _createElementVNode(\"div\", _hoisted_8, [_createVNode(_component_el_pagination, {\n      modelValue: $setup.page,\n      \"onUpdate:modelValue\": _cache[3] || (_cache[3] = $event => $setup.page = $event),\n      \"page-size\": $setup.size,\n      \"page-sizes\": $setup.pageSizes,\n      layout: \"total,sizes, prev, pager, next, jumper\",\n      total: $setup.total,\n      onSizeChange: $setup.handleSizeChange,\n      onCurrentChange: $setup.handleCurrentChange\n    }, null, 8 /* PROPS */, [\"modelValue\", \"page-size\", \"total\"])])]),\n    _: 1 /* STABLE */\n  }), _createCommentVNode(\" 详情对话框 \"), _createVNode(_component_el_dialog, {\n    modelValue: $setup.dialogVisible,\n    \"onUpdate:modelValue\": _cache[4] || (_cache[4] = $event => $setup.dialogVisible = $event),\n    title: \"日志详情\",\n    width: \"60%\",\n    fullscreen: $setup.getters.isMobile\n  }, {\n    default: _withCtx(() => [_createVNode(_component_el_descriptions, {\n      \"label-align\": \"left\",\n      column: 1,\n      border: \"\",\n      \"label-width\": \"30\"\n    }, {\n      default: _withCtx(() => [_createVNode(_component_el_descriptions_item, {\n        label: \"用户信息\"\n      }, {\n        default: _withCtx(() => [_createElementVNode(\"div\", _hoisted_9, [_createVNode(_component_el_avatar, {\n          size: 32,\n          src: $setup.currentLog.user?.avatar\n        }, null, 8 /* PROPS */, [\"src\"]), _createElementVNode(\"span\", null, _toDisplayString($setup.currentLog.user?.username) + \" (ID: \" + _toDisplayString($setup.currentLog.user?.id) + \")\", 1 /* TEXT */)])]),\n        _: 1 /* STABLE */\n      }), _createVNode(_component_el_descriptions_item, {\n        label: \"请求头\"\n      }, {\n        default: _withCtx(() => [_createVNode($setup[\"VueJsonPretty\"], {\n          data: $setup.parseJson($setup.currentLog.reqHeader),\n          deep: 2,\n          \"show-double-quotes\": true,\n          \"show-length\": true,\n          \"collapsed-level\": 2,\n          \"show-line\": true,\n          \"show-line-number\": true,\n          path: \"root\",\n          class: \"json-viewer\"\n        }, null, 8 /* PROPS */, [\"data\"])]),\n        _: 1 /* STABLE */\n      }), _createVNode(_component_el_descriptions_item, {\n        label: \"请求体\"\n      }, {\n        default: _withCtx(() => [_createVNode($setup[\"VueJsonPretty\"], {\n          data: $setup.parseJson($setup.currentLog.reqBody),\n          deep: 2,\n          \"show-double-quotes\": true,\n          \"show-length\": true,\n          \"collapsed-level\": 2,\n          \"show-line\": true,\n          \"show-line-number\": true,\n          path: \"root\",\n          class: \"json-viewer\"\n        }, null, 8 /* PROPS */, [\"data\"])]),\n        _: 1 /* STABLE */\n      }), _createVNode(_component_el_descriptions_item, {\n        label: \"请求参数\"\n      }, {\n        default: _withCtx(() => [_createVNode($setup[\"VueJsonPretty\"], {\n          data: $setup.parseJson($setup.currentLog.reqQuery),\n          deep: 2,\n          \"show-double-quotes\": true,\n          \"show-length\": true,\n          \"collapsed-level\": 2,\n          \"show-line\": true,\n          \"show-line-number\": true,\n          path: \"root\",\n          class: \"json-viewer\"\n        }, null, 8 /* PROPS */, [\"data\"])]),\n        _: 1 /* STABLE */\n      }), _createVNode(_component_el_descriptions_item, {\n        label: \"响应数据\"\n      }, {\n        default: _withCtx(() => [_createVNode($setup[\"VueJsonPretty\"], {\n          data: $setup.parseJson($setup.currentLog.resBody),\n          deep: 2,\n          \"show-double-quotes\": true,\n          \"show-length\": true,\n          \"collapsed-level\": 2,\n          \"show-line\": true,\n          \"show-line-number\": true,\n          path: \"root\",\n          class: \"json-viewer\"\n        }, null, 8 /* PROPS */, [\"data\"])]),\n        _: 1 /* STABLE */\n      })]),\n      _: 1 /* STABLE */\n    })]),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"modelValue\", \"fullscreen\"])]);\n}","map":{"version":3,"names":["class","_createElementBlock","_hoisted_1","_createVNode","_component_el_card","shadow","default","_withCtx","_createCommentVNode","_createElementVNode","_hoisted_2","_component_el_form","inline","model","$setup","searchForm","_component_el_form_item","label","_component_el_select","modelValue","userId","_cache","$event","placeholder","clearable","filterable","filterUsers","remote","_Fragment","_renderList","filteredUserList","user","_createBlock","_component_el_option","key","id","username","value","_hoisted_3","_component_el_avatar","size","src","avatar","_toDisplayString","_hoisted_4","_","_component_el_date_picker","style","timeRange","type","format","_component_el_button","onClick","handleSearch","_createTextVNode","handleReset","_hoisted_5","_hoisted_6","deleteTimeRange","handleDelete","_component_el_table","data","logList","border","onSortChange","handleSortChange","prop","order","_component_el_table_column","width","row","_hoisted_7","sortable","formatDateTime","time","fixed","scope","link","showDetail","loading","_hoisted_8","_component_el_pagination","page","pageSizes","layout","total","onSizeChange","handleSizeChange","onCurrentChange","handleCurrentChange","_component_el_dialog","dialogVisible","title","fullscreen","getters","isMobile","_component_el_descriptions","column","_component_el_descriptions_item","_hoisted_9","currentLog","parseJson","reqHeader","deep","path","reqBody","reqQuery","resBody"],"sources":["D:\\myproject\\毕业设计\\pet-mall\\apps\\admin\\src\\views\\Log\\User\\index.vue"],"sourcesContent":["<template>\r\n    <div class=\"user-log-container\">\r\n        <el-card shadow=\"never\">\r\n            <!-- 查询部分 -->\r\n            <div class=\"search-section\">\r\n                <h3 class=\"section-title\">查询条件</h3>\r\n                <el-form :inline=\"false\" :model=\"searchForm\">\r\n                    <el-form-item label=\"用户\">\r\n                        <el-select\r\n                            v-model=\"searchForm.userId\"\r\n                            placeholder=\"请选择用户\"\r\n                            clearable\r\n                            filterable\r\n                            :filter-method=\"filterUsers\"\r\n                            remote\r\n                            reserve-keyword\r\n                        >\r\n                            <el-option\r\n                                v-for=\"user in filteredUserList\"\r\n                                :key=\"user.id\"\r\n                                :label=\"user.username\"\r\n                                :value=\"user.id\"\r\n                            >\r\n                                <div class=\"user-option\">\r\n                                    <el-avatar :size=\"24\" :src=\"user.avatar\" />\r\n                                    <span>{{ user.username }}</span>\r\n                                    <span class=\"user-id\">(ID: {{ user.id }})</span>\r\n                                </div>\r\n                            </el-option>\r\n                        </el-select>\r\n                    </el-form-item>\r\n                    <el-form-item label=\"查询时间\">\r\n                        <el-date-picker style=\"max-width: 320px\" v-model=\"searchForm.timeRange\" type=\"datetimerange\" range-separator=\"至\"\r\n                            start-placeholder=\"开始时间\" end-placeholder=\"结束时间\" format=\"YYYY-MM-DD HH:mm:ss\"\r\n                            value-format=\"YYYY-MM-DD HH:mm:ss\" />\r\n                    </el-form-item>\r\n                    <el-form-item>\r\n                        <el-button type=\"primary\" @click=\"handleSearch\">查询</el-button>\r\n                        <el-button @click=\"handleReset\">重置</el-button>\r\n                    </el-form-item>\r\n                </el-form>\r\n            </div>\r\n\r\n            <!-- 删除部分 -->\r\n            <div class=\"delete-section\">\r\n                <h3 class=\"section-title\">批量删除</h3>\r\n                <div class=\"delete-form\">\r\n                    <el-date-picker v-model=\"deleteTimeRange\" type=\"datetimerange\" range-separator=\"至\"\r\n                        start-placeholder=\"删除开始时间\" end-placeholder=\"删除结束时间\" format=\"YYYY-MM-DD HH:mm:ss\"\r\n                        value-format=\"YYYY-MM-DD HH:mm:ss\" style=\"max-width: 320px\" />\r\n                    <el-button type=\"danger\" @click=\"handleDelete\" v-permission=\"'delete-user-log'\">删除选中时间段日志</el-button>\r\n                </div>\r\n            </div>\r\n\r\n            <el-table :data=\"logList\" border style=\"width: 100%\" v-loading=\"loading\" @sort-change=\"handleSortChange\" :default-sort=\"{ prop: 'time', order: 'descending' }\">\r\n                <el-table-column prop=\"id\" label=\"ID\" width=\"80\" />\r\n                <el-table-column label=\"用户信息\" width=\"200\">\r\n                    <template #default=\"{ row }\">\r\n                        <div class=\"user-info\">\r\n                            <el-avatar :size=\"32\" :src=\"row.user?.avatar\" />\r\n                            <span>{{ row.user?.username }} (ID: {{ row.user?.id }})</span>\r\n                        </div>\r\n                    </template>\r\n                </el-table-column>\r\n                <el-table-column prop=\"path\" label=\"请求路径\" show-overflow-tooltip />\r\n                <el-table-column prop=\"methods\" label=\"请求方法\" width=\"100\" />\r\n                <el-table-column prop=\"ip\" label=\"IP地址\" width=\"150\" />\r\n                <el-table-column prop=\"time\" label=\"请求时间\" width=\"180\" sortable=\"custom\">\r\n                    <template #default=\"{ row }\">\r\n                        {{ formatDateTime(row.time) }}\r\n                    </template>\r\n                </el-table-column>\r\n                <el-table-column prop=\"handeTime\" label=\"处理时长(ms)\" width=\"120\" />\r\n                <el-table-column label=\"详情\" width=\"80\" fixed=\"right\">\r\n                    <template #default=\"scope\">\r\n                        <el-button link type=\"primary\" @click=\"showDetail(scope.row)\">查看</el-button>\r\n                    </template>\r\n                </el-table-column>\r\n            </el-table>\r\n\r\n            <div class=\"pagination\">\r\n                <el-pagination\r\n                v-model=\"page\"\r\n                :page-size=\"size\"\r\n                :page-sizes=\"pageSizes\"\r\n                layout=\"total,sizes, prev, pager, next, jumper\"\r\n                :total=\"total\"\r\n                @size-change=\"handleSizeChange\"\r\n                @current-change=\"handleCurrentChange\" />\r\n            </div>\r\n        </el-card>\r\n\r\n        <!-- 详情对话框 -->\r\n        <el-dialog v-model=\"dialogVisible\" title=\"日志详情\" width=\"60%\" :fullscreen=\"getters.isMobile\">\r\n            <el-descriptions label-align='left' :column=\"1\" border label-width='30'>\r\n                <el-descriptions-item label=\"用户信息\">\r\n                    <div class=\"user-info\">\r\n                        <el-avatar :size=\"32\" :src=\"currentLog.user?.avatar\" />\r\n                        <span>{{ currentLog.user?.username }} (ID: {{ currentLog.user?.id }})</span>\r\n                    </div>\r\n                </el-descriptions-item>\r\n                <el-descriptions-item label=\"请求头\">\r\n                    <vue-json-pretty\r\n                        :data=\"parseJson(currentLog.reqHeader)\"\r\n                        :deep=\"2\"\r\n                        :show-double-quotes=\"true\"\r\n                        :show-length=\"true\"\r\n                        :collapsed-level=\"2\"\r\n                        :show-line=\"true\"\r\n                        :show-line-number=\"true\"\r\n                        path=\"root\"\r\n                        class=\"json-viewer\"\r\n                    />\r\n                </el-descriptions-item>\r\n                <el-descriptions-item label=\"请求体\">\r\n                    <vue-json-pretty\r\n                        :data=\"parseJson(currentLog.reqBody)\"\r\n                        :deep=\"2\"\r\n                        :show-double-quotes=\"true\"\r\n                        :show-length=\"true\"\r\n                        :collapsed-level=\"2\"\r\n                        :show-line=\"true\"\r\n                        :show-line-number=\"true\"\r\n                        path=\"root\"\r\n                        class=\"json-viewer\"\r\n                    />\r\n                </el-descriptions-item>\r\n                <el-descriptions-item label=\"请求参数\">\r\n                    <vue-json-pretty\r\n                        :data=\"parseJson(currentLog.reqQuery)\"\r\n                        :deep=\"2\"\r\n                        :show-double-quotes=\"true\"\r\n                        :show-length=\"true\"\r\n                        :collapsed-level=\"2\"\r\n                        :show-line=\"true\"\r\n                        :show-line-number=\"true\"\r\n                        path=\"root\"\r\n                        class=\"json-viewer\"\r\n                    />\r\n                </el-descriptions-item>\r\n                <el-descriptions-item label=\"响应数据\">\r\n                    <vue-json-pretty\r\n                        :data=\"parseJson(currentLog.resBody)\"\r\n                        :deep=\"2\"\r\n                        :show-double-quotes=\"true\"\r\n                        :show-length=\"true\"\r\n                        :collapsed-level=\"2\"\r\n                        :show-line=\"true\"\r\n                        :show-line-number=\"true\"\r\n                        path=\"root\"\r\n                        class=\"json-viewer\"\r\n                    />\r\n                </el-descriptions-item>\r\n            </el-descriptions>\r\n        </el-dialog>\r\n    </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, onMounted } from 'vue'\r\nimport { getUserLogs, deleteUserLogsByTimeRange } from '@/api/user-log'\r\nimport { getUserListAll } from '@/api/user-manage'\r\nimport { ElMessage, ElMessageBox } from 'element-plus'\r\nimport VueJsonPretty from 'vue-json-pretty'\r\nimport 'vue-json-pretty/lib/styles.css'\r\nimport { useStore } from 'vuex'\r\nconst { getters } = useStore()\r\n\r\nconst loading = ref(false)\r\nconst logList = ref([])\r\nconst page = ref(1)\r\nconst size = ref(5)\r\nconst pageSizes = [5, 10, 20, 30, 70, 100]\r\nconst total = ref(0)\r\nconst dialogVisible = ref(false)\r\nconst currentLog = ref({})\r\nconst deleteTimeRange = ref([])\r\nconst sortConfig = ref({\r\n  prop: 'time', // 默认按时间排序\r\n  order: 'descending' // 默认降序（最新的在前面）\r\n})\r\n\r\n// 用户列表相关\r\nconst userList = ref([])\r\nconst filteredUserList = ref([])\r\n\r\nconst searchForm = ref({\r\n  userId: null,\r\n  timeRange: []\r\n})\r\n\r\n// 获取日志列表\r\nconst getList = async () => {\r\n  loading.value = true\r\n  try {\r\n    const params = {\r\n      page: page.value,\r\n      size: size.value,\r\n      userId: searchForm.value.userId,\r\n      // 添加排序参数\r\n      sortBy: sortConfig.value.prop,\r\n      sortOrder: sortConfig.value.order === 'ascending' ? 'asc' : 'desc'\r\n    }\r\n\r\n    if (searchForm.value.timeRange?.length === 2) {\r\n      params.startDateStr = searchForm.value.timeRange[0]\r\n      params.endDateStr = searchForm.value.timeRange[1]\r\n    }\r\n\r\n    const res = await getUserLogs(params)\r\n    logList.value = res.list\r\n    total.value = res.total\r\n  } catch (error) {\r\n    console.error('获取日志列表失败：', error)\r\n  } finally {\r\n    loading.value = false\r\n  }\r\n}\r\n\r\n// 处理查询\r\nconst handleSearch = () => {\r\n  page.value = 1\r\n  getList()\r\n}\r\n\r\n// 重置查询条件\r\nconst handleReset = () => {\r\n  searchForm.value = {\r\n    userId: null,\r\n    timeRange: []\r\n  }\r\n  page.value = 1\r\n  getList()\r\n}\r\n\r\n// 格式化日期时间\r\nconst formatDateTime = (dateStr) => {\r\n  if (!dateStr) return ''\r\n  const date = new Date(dateStr)\r\n  return date.toLocaleString()\r\n}\r\n\r\n// 处理页码变化\r\nconst handleCurrentChange = (newPage) => {\r\n  page.value = newPage\r\n  getList()\r\n}\r\n\r\n// 处理每页条数变化\r\nconst handleSizeChange = (newSize) => {\r\n  size.value = newSize\r\n  getList()\r\n}\r\n\r\n// 删除日志\r\nconst handleDelete = async () => {\r\n  if (!deleteTimeRange.value || deleteTimeRange.value.length !== 2) {\r\n    return ElMessage.warning('请选择要删除的时间范围')\r\n  }\r\n\r\n  try {\r\n    await ElMessageBox.confirm('确定要删除选中时间范围内的日志吗？', '警告', {\r\n      type: 'warning'\r\n    })\r\n\r\n    const [startDateStr, endDateStr] = deleteTimeRange.value\r\n    await deleteUserLogsByTimeRange({\r\n      startDateStr,\r\n      endDateStr\r\n    })\r\n    ElMessage.success('删除成功')\r\n    getList()\r\n    deleteTimeRange.value = []\r\n  } catch (error) {\r\n    console.error('删除失败：', error)\r\n  }\r\n}\r\n\r\n// 显示日志详情\r\nconst showDetail = (log) => {\r\n  currentLog.value = log\r\n  dialogVisible.value = true\r\n}\r\n\r\n// 解析JSON字符串\r\nconst parseJson = (jsonStr) => {\r\n  try {\r\n    if (typeof jsonStr === 'string') {\r\n      return JSON.parse(jsonStr)\r\n    }\r\n    return jsonStr\r\n  } catch (e) {\r\n    return jsonStr\r\n  }\r\n}\r\n\r\n// 获取用户列表\r\nconst getUserList = async () => {\r\n  try {\r\n    const res = await getUserListAll()\r\n    userList.value = res.list\r\n    filteredUserList.value = res.list\r\n  } catch (error) {\r\n    console.error('获取用户列表失败：', error)\r\n  }\r\n}\r\n\r\n// 用户筛选方法\r\nconst filterUsers = (query) => {\r\n  if (!query) {\r\n    filteredUserList.value = userList.value\r\n    return\r\n  }\r\n\r\n  const lowercaseQuery = query.toLowerCase()\r\n  filteredUserList.value = userList.value.filter(user =>\r\n    user.username.toLowerCase().includes(lowercaseQuery) ||\r\n    String(user.id).includes(query)\r\n  )\r\n}\r\n\r\n// 处理表格排序变化\r\nconst handleSortChange = ({ prop, order }) => {\r\n  sortConfig.value = { prop, order }\r\n  getList()\r\n}\r\n\r\nonMounted(() => {\r\n  getList()\r\n  getUserList() // 获取用户列表\r\n})\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.user-log-container {\r\n    .section-title {\r\n        font-size: 16px;\r\n        font-weight: 500;\r\n        color: var(--theme-text-regular);\r\n        margin: 0 0 16px;\r\n        position: relative;\r\n        padding-left: 12px;\r\n\r\n        &::before {\r\n            content: '';\r\n            position: absolute;\r\n            left: 0;\r\n            top: 50%;\r\n            transform: translateY(-50%);\r\n            width: 4px;\r\n            height: 16px;\r\n            background-color: var(--theme-primary);\r\n            border-radius: 2px;\r\n        }\r\n    }\r\n\r\n    .search-section {\r\n        background-color: var(--theme-bg-container);\r\n        border: 1px solid var(--theme-border-light);\r\n        padding: 16px;\r\n        border-radius: 4px;\r\n        margin-bottom: 16px;\r\n    }\r\n\r\n    .delete-section {\r\n        background-color: var(--theme-danger-light);\r\n        border: 1px solid var(--theme-danger-border);\r\n        padding: 16px;\r\n        border-radius: 4px;\r\n        margin-bottom: 20px;\r\n\r\n        .delete-form {\r\n            display: flex;\r\n            gap: 12px;\r\n            align-items: center;\r\n        }\r\n    }\r\n\r\n    .user-info {\r\n        display: flex;\r\n        align-items: center;\r\n        gap: 8px;\r\n        color: var(--theme-text-regular);\r\n    }\r\n\r\n    .pagination {\r\n        margin-top: 10px;\r\n        display: flex;\r\n        justify-content: center;\r\n        :deep(.el-pagination) {\r\n          overflow-x: auto;\r\n        }\r\n    }\r\n}\r\n\r\n:root{\r\n    .el-popper .el-scrollbar .user-option {\r\n        display: flex;\r\n        align-items: center;\r\n        gap: 8px;\r\n\r\n        .user-id {\r\n            // color: #909399;\r\n            font-size: 12px;\r\n        }\r\n    }\r\n}\r\n\r\n// 自定义 el-select 的宽度\r\n:deep(.search-section .el-select) {\r\n    width: 240px;\r\n}\r\n</style>\r\n"],"mappings":";;EACSA,KAAK,EAAC;AAAoB;;EAGlBA,KAAK,EAAC;AAAgB;;EAmBFA,KAAK,EAAC;AAAa;;EAGdA,KAAK,EAAC;AAAS;;EAkBxCA,KAAK,EAAC;AAAgB;;EAElBA,KAAK,EAAC;AAAa;;EAYXA,KAAK,EAAC;AAAW;;EAsB7BA,KAAK,EAAC;AAAY;;EAgBVA,KAAK,EAAC;AAAW;;;;;;;;;;;;;;;;;;uBA/FtCC,mBAAA,CA0JM,OA1JNC,UA0JM,GAzJFC,YAAA,CAwFUC,kBAAA;IAxFDC,MAAM,EAAC;EAAO;IAF/BC,OAAA,EAAAC,QAAA,CAGY,MAAa,CAAbC,mBAAA,UAAa,EACbC,mBAAA,CAqCM,OArCNC,UAqCM,G,0BApCFD,mBAAA,CAAmC;MAA/BT,KAAK,EAAC;IAAe,GAAC,MAAI,sBAC9BG,YAAA,CAkCUQ,kBAAA;MAlCAC,MAAM,EAAE,KAAK;MAAGC,KAAK,EAAEC,MAAA,CAAAC;;MANjDT,OAAA,EAAAC,QAAA,CAOoB,MAuBe,CAvBfJ,YAAA,CAuBea,uBAAA;QAvBDC,KAAK,EAAC;MAAI;QAP5CX,OAAA,EAAAC,QAAA,CAQwB,MAqBY,CArBZJ,YAAA,CAqBYe,oBAAA;UA7BpCC,UAAA,EASqCL,MAAA,CAAAC,UAAU,CAACK,MAAM;UATtD,uBAAAC,MAAA,QAAAA,MAAA,MAAAC,MAAA,IASqCR,MAAA,CAAAC,UAAU,CAACK,MAAM,GAAAE,MAAA;UAC1BC,WAAW,EAAC,OAAO;UACnBC,SAAS,EAAT,EAAS;UACTC,UAAU,EAAV,EAAU;UACT,eAAa,EAAEX,MAAA,CAAAY,WAAW;UAC3BC,MAAM,EAAN,EAAM;UACN,iBAAe,EAAf;;UAf5BrB,OAAA,EAAAC,QAAA,CAkBgC,MAAgC,E,kBADpCN,mBAAA,CAWY2B,SAAA,QA5BxCC,WAAA,CAkB+Cf,MAAA,CAAAgB,gBAAgB,EAAxBC,IAAI;iCADfC,YAAA,CAWYC,oBAAA;cATPC,GAAG,EAAEH,IAAI,CAACI,EAAE;cACZlB,KAAK,EAAEc,IAAI,CAACK,QAAQ;cACpBC,KAAK,EAAEN,IAAI,CAACI;;cArB7C7B,OAAA,EAAAC,QAAA,CAuBgC,MAIM,CAJNE,mBAAA,CAIM,OAJN6B,UAIM,GAHFnC,YAAA,CAA2CoC,oBAAA;gBAA/BC,IAAI,EAAE,EAAE;gBAAGC,GAAG,EAAEV,IAAI,CAACW;gDACjCjC,mBAAA,CAAgC,cAAAkC,gBAAA,CAAvBZ,IAAI,CAACK,QAAQ,kBACtB3B,mBAAA,CAAgD,QAAhDmC,UAAgD,EAA1B,OAAK,GAAAD,gBAAA,CAAGZ,IAAI,CAACI,EAAE,IAAG,GAAC,gB;cA1B7EU,CAAA;;;UAAAA,CAAA;;QAAAA,CAAA;UA+BoB1C,YAAA,CAIea,uBAAA;QAJDC,KAAK,EAAC;MAAM;QA/B9CX,OAAA,EAAAC,QAAA,CAgCwB,MAEyC,CAFzCJ,YAAA,CAEyC2C,yBAAA;UAFzBC,KAAwB,EAAxB;YAAA;UAAA,CAAwB;UAhChE5B,UAAA,EAgC0EL,MAAA,CAAAC,UAAU,CAACiC,SAAS;UAhC9F,uBAAA3B,MAAA,QAAAA,MAAA,MAAAC,MAAA,IAgC0ER,MAAA,CAAAC,UAAU,CAACiC,SAAS,GAAA1B,MAAA;UAAE2B,IAAI,EAAC,eAAe;UAAC,iBAAe,EAAC,GAAG;UAC5G,mBAAiB,EAAC,MAAM;UAAC,iBAAe,EAAC,MAAM;UAACC,MAAM,EAAC,qBAAqB;UAC5E,cAAY,EAAC;;QAlCzCL,CAAA;UAoCoB1C,YAAA,CAGea,uBAAA;QAvCnCV,OAAA,EAAAC,QAAA,CAqCwB,MAA8D,CAA9DJ,YAAA,CAA8DgD,oBAAA;UAAnDF,IAAI,EAAC,SAAS;UAAEG,OAAK,EAAEtC,MAAA,CAAAuC;;UArC1D/C,OAAA,EAAAC,QAAA,CAqCwE,MAAEc,MAAA,QAAAA,MAAA,OArC1EiC,gBAAA,CAqCwE,IAAE,E;UArC1ET,CAAA;YAsCwB1C,YAAA,CAA8CgD,oBAAA;UAAlCC,OAAK,EAAEtC,MAAA,CAAAyC;QAAW;UAtCtDjD,OAAA,EAAAC,QAAA,CAsCwD,MAAEc,MAAA,QAAAA,MAAA,OAtC1DiC,gBAAA,CAsCwD,IAAE,E;UAtC1DT,CAAA;;QAAAA,CAAA;;MAAAA,CAAA;oCA2CYrC,mBAAA,UAAa,EACbC,mBAAA,CAQM,OARN+C,UAQM,G,0BAPF/C,mBAAA,CAAmC;MAA/BT,KAAK,EAAC;IAAe,GAAC,MAAI,sBAC9BS,mBAAA,CAKM,OALNgD,UAKM,GAJFtD,YAAA,CAEkE2C,yBAAA;MAjDtF3B,UAAA,EA+C6CL,MAAA,CAAA4C,eAAe;MA/C5D,uBAAArC,MAAA,QAAAA,MAAA,MAAAC,MAAA,IA+C6CR,MAAA,CAAA4C,eAAe,GAAApC,MAAA;MAAE2B,IAAI,EAAC,eAAe;MAAC,iBAAe,EAAC,GAAG;MAC9E,mBAAiB,EAAC,QAAQ;MAAC,iBAAe,EAAC,QAAQ;MAACC,MAAM,EAAC,qBAAqB;MAChF,cAAY,EAAC,qBAAqB;MAACH,KAAwB,EAAxB;QAAA;MAAA;4EACvCf,YAAA,CAAqGmB,oBAAA;MAA1FF,IAAI,EAAC,QAAQ;MAAEG,OAAK,EAAEtC,MAAA,CAAA6C;;MAlDrDrD,OAAA,EAAAC,QAAA,CAkDoG,MAASc,MAAA,QAAAA,MAAA,OAlD7GiC,gBAAA,CAkDoG,WAAS,E;MAlD7GT,CAAA;kCAkDiF,iBAAiB,E,sCAItFb,YAAA,CAwBW4B,mBAAA;MAxBAC,IAAI,EAAE/C,MAAA,CAAAgD,OAAO;MAAEC,MAAM,EAAN,EAAM;MAAChB,KAAmB,EAAnB;QAAA;MAAA,CAAmB;MAAsBiB,YAAW,EAAElD,MAAA,CAAAmD,gBAAgB;MAAG,cAAY,EAAE;QAAAC,IAAA;QAAAC,KAAA;MAAA;;MAtDpI7D,OAAA,EAAAC,QAAA,CAuDgB,MAAmD,CAAnDJ,YAAA,CAAmDiE,0BAAA;QAAlCF,IAAI,EAAC,IAAI;QAACjD,KAAK,EAAC,IAAI;QAACoD,KAAK,EAAC;UAC5ClE,YAAA,CAOkBiE,0BAAA;QAPDnD,KAAK,EAAC,MAAM;QAACoD,KAAK,EAAC;;QACrB/D,OAAO,EAAAC,QAAA,CACd,CAGM;UAJY+D;QAAG,OACrB7D,mBAAA,CAGM,OAHN8D,UAGM,GAFFpE,YAAA,CAAgDoC,oBAAA;UAApCC,IAAI,EAAE,EAAE;UAAGC,GAAG,EAAE6B,GAAG,CAACvC,IAAI,EAAEW;0CACtCjC,mBAAA,CAA8D,cAAAkC,gBAAA,CAArD2B,GAAG,CAACvC,IAAI,EAAEK,QAAQ,IAAG,QAAM,GAAAO,gBAAA,CAAG2B,GAAG,CAACvC,IAAI,EAAEI,EAAE,IAAG,GAAC,gB;QA5DnFU,CAAA;UAgEgB1C,YAAA,CAAkEiE,0BAAA;QAAjDF,IAAI,EAAC,MAAM;QAACjD,KAAK,EAAC,MAAM;QAAC,uBAAqB,EAArB;UAC1Cd,YAAA,CAA2DiE,0BAAA;QAA1CF,IAAI,EAAC,SAAS;QAACjD,KAAK,EAAC,MAAM;QAACoD,KAAK,EAAC;UACnDlE,YAAA,CAAsDiE,0BAAA;QAArCF,IAAI,EAAC,IAAI;QAACjD,KAAK,EAAC,MAAM;QAACoD,KAAK,EAAC;UAC9ClE,YAAA,CAIkBiE,0BAAA;QAJDF,IAAI,EAAC,MAAM;QAACjD,KAAK,EAAC,MAAM;QAACoD,KAAK,EAAC,KAAK;QAACG,QAAQ,EAAC;;QAChDlE,OAAO,EAAAC,QAAA,CACd,CAA8B;UADZ+D;QAAG,OApE7ChB,gBAAA,CAAAX,gBAAA,CAqE2B7B,MAAA,CAAA2D,cAAc,CAACH,GAAG,CAACI,IAAI,kB;QArElD7B,CAAA;UAwEgB1C,YAAA,CAAiEiE,0BAAA;QAAhDF,IAAI,EAAC,WAAW;QAACjD,KAAK,EAAC,UAAU;QAACoD,KAAK,EAAC;UACzDlE,YAAA,CAIkBiE,0BAAA;QAJDnD,KAAK,EAAC,IAAI;QAACoD,KAAK,EAAC,IAAI;QAACM,KAAK,EAAC;;QAC9BrE,OAAO,EAAAC,QAAA,CAC8DqE,KADvD,KACrBzE,YAAA,CAA4EgD,oBAAA;UAAjE0B,IAAI,EAAJ,EAAI;UAAC5B,IAAI,EAAC,SAAS;UAAEG,OAAK,EAAA9B,MAAA,IAAER,MAAA,CAAAgE,UAAU,CAACF,KAAK,CAACN,GAAG;;UA3EnFhE,OAAA,EAAAC,QAAA,CA2EsF,MAAEc,MAAA,SAAAA,MAAA,QA3ExFiC,gBAAA,CA2EsF,IAAE,E;UA3ExFT,CAAA;;QAAAA,CAAA;;MAAAA,CAAA;wDAsD4E/B,MAAA,CAAAiE,OAAO,E,GA0BvEtE,mBAAA,CASM,OATNuE,UASM,GARF7E,YAAA,CAOwC8E,wBAAA;MAxFxD9D,UAAA,EAkFyBL,MAAA,CAAAoE,IAAI;MAlF7B,uBAAA7D,MAAA,QAAAA,MAAA,MAAAC,MAAA,IAkFyBR,MAAA,CAAAoE,IAAI,GAAA5D,MAAA;MACZ,WAAS,EAAER,MAAA,CAAA0B,IAAI;MACf,YAAU,EAAE1B,MAAA,CAAAqE,SAAS;MACtBC,MAAM,EAAC,wCAAwC;MAC9CC,KAAK,EAAEvE,MAAA,CAAAuE,KAAK;MACZC,YAAW,EAAExE,MAAA,CAAAyE,gBAAgB;MAC7BC,eAAc,EAAE1E,MAAA,CAAA2E;;IAxFjC5C,CAAA;MA4FQrC,mBAAA,WAAc,EACdL,YAAA,CA6DYuF,oBAAA;IA1JpBvE,UAAA,EA6F4BL,MAAA,CAAA6E,aAAa;IA7FzC,uBAAAtE,MAAA,QAAAA,MAAA,MAAAC,MAAA,IA6F4BR,MAAA,CAAA6E,aAAa,GAAArE,MAAA;IAAEsE,KAAK,EAAC,MAAM;IAACvB,KAAK,EAAC,KAAK;IAAEwB,UAAU,EAAE/E,MAAA,CAAAgF,OAAO,CAACC;;IA7FzFzF,OAAA,EAAAC,QAAA,CA8FY,MA2DkB,CA3DlBJ,YAAA,CA2DkB6F,0BAAA;MA3DD,aAAW,EAAC,MAAM;MAAEC,MAAM,EAAE,CAAC;MAAElC,MAAM,EAAN,EAAM;MAAC,aAAW,EAAC;;MA9F/EzD,OAAA,EAAAC,QAAA,CA+FgB,MAKuB,CALvBJ,YAAA,CAKuB+F,+BAAA;QALDjF,KAAK,EAAC;MAAM;QA/FlDX,OAAA,EAAAC,QAAA,CAgGoB,MAGM,CAHNE,mBAAA,CAGM,OAHN0F,UAGM,GAFFhG,YAAA,CAAuDoC,oBAAA;UAA3CC,IAAI,EAAE,EAAE;UAAGC,GAAG,EAAE3B,MAAA,CAAAsF,UAAU,CAACrE,IAAI,EAAEW;0CAC7CjC,mBAAA,CAA4E,cAAAkC,gBAAA,CAAnE7B,MAAA,CAAAsF,UAAU,CAACrE,IAAI,EAAEK,QAAQ,IAAG,QAAM,GAAAO,gBAAA,CAAG7B,MAAA,CAAAsF,UAAU,CAACrE,IAAI,EAAEI,EAAE,IAAG,GAAC,gB;QAlG7FU,CAAA;UAqGgB1C,YAAA,CAYuB+F,+BAAA;QAZDjF,KAAK,EAAC;MAAK;QArGjDX,OAAA,EAAAC,QAAA,CAsGoB,MAUE,CAVFJ,YAAA,CAUEW,MAAA;UATG+C,IAAI,EAAE/C,MAAA,CAAAuF,SAAS,CAACvF,MAAA,CAAAsF,UAAU,CAACE,SAAS;UACpCC,IAAI,EAAE,CAAC;UACP,oBAAkB,EAAE,IAAI;UACxB,aAAW,EAAE,IAAI;UACjB,iBAAe,EAAE,CAAC;UAClB,WAAS,EAAE,IAAI;UACf,kBAAgB,EAAE,IAAI;UACvBC,IAAI,EAAC,MAAM;UACXxG,KAAK,EAAC;;QA/G9B6C,CAAA;UAkHgB1C,YAAA,CAYuB+F,+BAAA;QAZDjF,KAAK,EAAC;MAAK;QAlHjDX,OAAA,EAAAC,QAAA,CAmHoB,MAUE,CAVFJ,YAAA,CAUEW,MAAA;UATG+C,IAAI,EAAE/C,MAAA,CAAAuF,SAAS,CAACvF,MAAA,CAAAsF,UAAU,CAACK,OAAO;UAClCF,IAAI,EAAE,CAAC;UACP,oBAAkB,EAAE,IAAI;UACxB,aAAW,EAAE,IAAI;UACjB,iBAAe,EAAE,CAAC;UAClB,WAAS,EAAE,IAAI;UACf,kBAAgB,EAAE,IAAI;UACvBC,IAAI,EAAC,MAAM;UACXxG,KAAK,EAAC;;QA5H9B6C,CAAA;UA+HgB1C,YAAA,CAYuB+F,+BAAA;QAZDjF,KAAK,EAAC;MAAM;QA/HlDX,OAAA,EAAAC,QAAA,CAgIoB,MAUE,CAVFJ,YAAA,CAUEW,MAAA;UATG+C,IAAI,EAAE/C,MAAA,CAAAuF,SAAS,CAACvF,MAAA,CAAAsF,UAAU,CAACM,QAAQ;UACnCH,IAAI,EAAE,CAAC;UACP,oBAAkB,EAAE,IAAI;UACxB,aAAW,EAAE,IAAI;UACjB,iBAAe,EAAE,CAAC;UAClB,WAAS,EAAE,IAAI;UACf,kBAAgB,EAAE,IAAI;UACvBC,IAAI,EAAC,MAAM;UACXxG,KAAK,EAAC;;QAzI9B6C,CAAA;UA4IgB1C,YAAA,CAYuB+F,+BAAA;QAZDjF,KAAK,EAAC;MAAM;QA5IlDX,OAAA,EAAAC,QAAA,CA6IoB,MAUE,CAVFJ,YAAA,CAUEW,MAAA;UATG+C,IAAI,EAAE/C,MAAA,CAAAuF,SAAS,CAACvF,MAAA,CAAAsF,UAAU,CAACO,OAAO;UAClCJ,IAAI,EAAE,CAAC;UACP,oBAAkB,EAAE,IAAI;UACxB,aAAW,EAAE,IAAI;UACjB,iBAAe,EAAE,CAAC;UAClB,WAAS,EAAE,IAAI;UACf,kBAAgB,EAAE,IAAI;UACvBC,IAAI,EAAC,MAAM;UACXxG,KAAK,EAAC;;QAtJ9B6C,CAAA;;MAAAA,CAAA;;IAAAA,CAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}