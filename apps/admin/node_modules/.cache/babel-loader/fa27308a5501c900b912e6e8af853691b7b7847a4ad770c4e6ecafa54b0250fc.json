{"ast":null,"code":"import { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createBlock as _createBlock, createVNode as _createVNode, createElementVNode as _createElementVNode, createCommentVNode as _createCommentVNode } from \"vue\";\nconst _hoisted_1 = {\n  key: 0\n};\nconst _hoisted_2 = {\n  class: \"right-btn-container\"\n};\nconst _hoisted_3 = {\n  key: 1,\n  class: \"loading-container\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_el_checkbox = _resolveComponent(\"el-checkbox\");\n  const _component_el_checkbox_group = _resolveComponent(\"el-checkbox-group\");\n  const _component_el_button = _resolveComponent(\"el-button\");\n  const _component_Loading = _resolveComponent(\"Loading\");\n  const _component_el_icon = _resolveComponent(\"el-icon\");\n  const _component_el_dialog = _resolveComponent(\"el-dialog\");\n  return _openBlock(), _createElementBlock(\"div\", null, [_createVNode(_component_el_dialog, {\n    modelValue: $setup.isShow,\n    \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => $setup.isShow = $event),\n    fullscreen: $setup.getters.isMobile,\n    title: _ctx.$t('AssignRoles.index.017835-0'),\n    onClosed: $setup.resetInfo\n  }, {\n    default: _withCtx(() => [$setup.beReady ? (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createVNode(_component_el_checkbox_group, {\n      modelValue: $setup.selectedRolesList,\n      \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $setup.selectedRolesList = $event)\n    }, {\n      default: _withCtx(() => [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.showRoleList, (role, i) => {\n        return _openBlock(), _createBlock(_component_el_checkbox, {\n          key: i,\n          label: role,\n          checked: role.checked\n        }, {\n          default: _withCtx(() => [_createTextVNode(_toDisplayString(role.name), 1 /* TEXT */)]),\n          _: 2 /* DYNAMIC */\n        }, 1032 /* PROPS, DYNAMIC_SLOTS */, [\"label\", \"checked\"]);\n      }), 128 /* KEYED_FRAGMENT */))]),\n      _: 1 /* STABLE */\n    }, 8 /* PROPS */, [\"modelValue\"]), _createElementVNode(\"div\", _hoisted_2, [_createVNode(_component_el_button, {\n      type: \"primary\",\n      onClick: $setup.assignRoles\n    }, {\n      default: _withCtx(() => [_createTextVNode(_toDisplayString(_ctx.$t('AssignRoles.index.017835-1')), 1 /* TEXT */)]),\n      _: 1 /* STABLE */\n    })])])) : (_openBlock(), _createElementBlock(\"div\", _hoisted_3, [_createVNode(_component_el_icon, {\n      size: 20,\n      class: \"is-loading\"\n    }, {\n      default: _withCtx(() => [_createVNode(_component_Loading)]),\n      _: 1 /* STABLE */\n    })]))]),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"modelValue\", \"fullscreen\", \"title\"])]);\n}","map":{"version":3,"names":["key","class","_createElementBlock","_createVNode","_component_el_dialog","modelValue","$setup","isShow","_cache","$event","fullscreen","getters","isMobile","title","_ctx","$t","onClosed","resetInfo","default","_withCtx","beReady","_hoisted_1","_component_el_checkbox_group","selectedRolesList","_Fragment","_renderList","showRoleList","role","i","_createBlock","_component_el_checkbox","label","checked","_createTextVNode","_toDisplayString","name","_","_createElementVNode","_hoisted_2","_component_el_button","type","onClick","assignRoles","_hoisted_3","_component_el_icon","size","_component_Loading"],"sources":["D:\\myproject\\毕业设计\\pet-mall\\apps\\admin\\src\\views\\Acl\\User\\components\\AssignRoles\\index.vue"],"sourcesContent":["<template>\r\n  <div>\r\n    <el-dialog\r\n      v-model=\"isShow\"\r\n      :fullscreen=\"getters.isMobile\"\r\n      :title=\"$t('AssignRoles.index.017835-0')\"\r\n      @closed=\"resetInfo\"\r\n    >\r\n      <div v-if=\"beReady\">\r\n        <el-checkbox-group v-model=\"selectedRolesList\">\r\n          <el-checkbox\r\n            v-for=\"(role, i) of showRoleList\"\r\n            :key=\"i\"\r\n            :label=\"role\"\r\n            :checked=\"role.checked\"\r\n            >{{ role.name }}</el-checkbox\r\n          >\r\n        </el-checkbox-group>\r\n        <div class=\"right-btn-container\">\r\n          <el-button type=\"primary\" @click=\"assignRoles\">{{ $t('AssignRoles.index.017835-1') }}</el-button>\r\n        </div>\r\n      </div>\r\n      <div v-else class=\"loading-container\">\r\n        <el-icon :size=\"20\" class=\"is-loading\"><Loading /></el-icon>\r\n      </div>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { useStore } from 'vuex'\r\nimport { defineEmits, defineProps, computed, ref, onMounted, watch } from 'vue'\r\nimport { getRoleList } from '@/api/role-manage'\r\nimport { getUserRole, assignRolesToUser } from '@/api/user-manage'\r\nconst { getters } = useStore()\r\nconst props = defineProps({\r\n  modelValue: {\r\n    required: true,\r\n    defualt: false\r\n  },\r\n  userId: {\r\n    required: true\r\n  }\r\n})\r\nconst beReady = ref(false)\r\nconst isShow = computed({\r\n  get() {\r\n    return props.modelValue\r\n  },\r\n  set(val) {\r\n    emit('update:modelValue', val)\r\n  }\r\n})\r\nconst emit = defineEmits(['update:modelValue', 'complete'])\r\nconst roleList = ref([])\r\nconst userRoleList = ref([])\r\nconst selectedRolesList = ref([])\r\nconst showRoleList = ref([])\r\n\r\nwatch(props, async (props) => {\r\n  if (props.modelValue) {\r\n    await getRoleListInfo()\r\n    await getUserRoleListInfo()\r\n    getShowRoleList()\r\n    beReady.value = true\r\n  }\r\n})\r\n\r\nasync function getRoleListInfo() {\r\n  roleList.value = await getRoleList()\r\n}\r\nasync function getUserRoleListInfo() {\r\n  const { role } = await getUserRole(props.userId)\r\n  userRoleList.value = role.map((item) => {\r\n    item.checked = true\r\n    return item\r\n  })\r\n}\r\nfunction getShowRoleList() {\r\n  showRoleList.value = []\r\n  for (const item of roleList.value) {\r\n    const index = userRoleList.value.findIndex((role) => role.id === item.id)\r\n    if (index !== -1) {\r\n      showRoleList.value.push(userRoleList.value[index])\r\n    } else {\r\n      showRoleList.value.push(item)\r\n    }\r\n  }\r\n}\r\nasync function assignRoles() {\r\n  selectedRolesList.value.forEach((item) => delete item.checked)\r\n  await assignRolesToUser(props.userId, selectedRolesList.value).then(() => {\r\n    isShow.value = false\r\n    emit('complete')\r\n  })\r\n}\r\n\r\nfunction resetInfo() {\r\n  userRoleList.value = []\r\n  roleList.value = []\r\n  showRoleList.value = []\r\n  selectedRolesList.value = []\r\n  beReady.value = false\r\n}\r\nonMounted(() => {})\r\n</script>\r\n\r\n<style scoped>\r\n.right-btn-container {\r\n  display: flex;\r\n  justify-content: right;\r\n}\r\n.loading-container {\r\n  display: flex;\r\n  justify-content: center;\r\n}\r\n</style>\r\n"],"mappings":";;EAAAA,GAAA;AAAA;;EAkBaC,KAAK,EAAC;AAAqB;;EAlBxCD,GAAA;EAsBkBC,KAAK,EAAC;;;;;;;;;uBArBtBC,mBAAA,CAyBM,cAxBJC,YAAA,CAuBYC,oBAAA;IAzBhBC,UAAA,EAGeC,MAAA,CAAAC,MAAM;IAHrB,uBAAAC,MAAA,QAAAA,MAAA,MAAAC,MAAA,IAGeH,MAAA,CAAAC,MAAM,GAAAE,MAAA;IACdC,UAAU,EAAEJ,MAAA,CAAAK,OAAO,CAACC,QAAQ;IAC5BC,KAAK,EAAEC,IAAA,CAAAC,EAAE;IACTC,QAAM,EAAEV,MAAA,CAAAW;;IANfC,OAAA,EAAAC,QAAA,CAMU,MAeyD,CAblDb,MAAA,CAAAc,OAAO,I,cAAlBlB,mBAAA,CAaM,OArBZmB,UAAA,GASQlB,YAAA,CAQoBmB,4BAAA;MAjB5BjB,UAAA,EASoCC,MAAA,CAAAiB,iBAAiB;MATrD,uBAAAf,MAAA,QAAAA,MAAA,MAAAC,MAAA,IASoCH,MAAA,CAAAiB,iBAAiB,GAAAd,MAAA;;MATrDS,OAAA,EAAAC,QAAA,CAWY,MAAiC,E,kBADnCjB,mBAAA,CAK4CsB,SAAA,QAftDC,WAAA,CAWgCnB,MAAA,CAAAoB,YAAY,EAX5C,CAWoBC,IAAI,EAAEC,CAAC;6BADjBC,YAAA,CAK4CC,sBAAA;UAHzC9B,GAAG,EAAE4B,CAAC;UACNG,KAAK,EAAEJ,IAAI;UACXK,OAAO,EAAEL,IAAI,CAACK;;UAd3Bd,OAAA,EAAAC,QAAA,CAea,MAAe,CAf5Bc,gBAAA,CAAAC,gBAAA,CAegBP,IAAI,CAACQ,IAAI,iB;UAfzBC,CAAA;;;MAAAA,CAAA;uCAkBQC,mBAAA,CAEM,OAFNC,UAEM,GADJnC,YAAA,CAAiGoC,oBAAA;MAAtFC,IAAI,EAAC,SAAS;MAAEC,OAAK,EAAEnC,MAAA,CAAAoC;;MAnB5CxB,OAAA,EAAAC,QAAA,CAmByD,MAAsC,CAnB/Fc,gBAAA,CAAAC,gBAAA,CAmB4DpB,IAAA,CAAAC,EAAE,+C;MAnB9DqB,CAAA;6BAsBMlC,mBAAA,CAEM,OAFNyC,UAEM,GADJxC,YAAA,CAA4DyC,kBAAA;MAAlDC,IAAI,EAAE,EAAE;MAAE5C,KAAK,EAAC;;MAvBlCiB,OAAA,EAAAC,QAAA,CAuB+C,MAAW,CAAXhB,YAAA,CAAW2C,kBAAA,E;MAvB1DV,CAAA;;IAAAA,CAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}