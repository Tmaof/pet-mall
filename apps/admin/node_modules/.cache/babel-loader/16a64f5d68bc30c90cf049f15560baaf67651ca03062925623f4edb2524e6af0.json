{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.for-each.js\";\nimport { addUserBatch } from '@/api/user-manage';\nimport { keys } from '../../../constant';\nexport default async function addUserByExcel(excelData, password) {\n  // console.log(excelData)\n  /**\r\n  {\r\n  header: ['姓名', '角色', '开通时间'],\r\n  results: [\r\n    {\r\n      姓名: '刘备',\r\n      角色: '管理员',\r\n      开通时间: 44420\r\n    }\r\n  ]\r\n  }\r\n   *\r\n   */\n  const dataList = [];\n  for (const info of excelData.results) {\n    const obj = {\n      password\n    };\n    Object.keys(info).forEach(key => {\n      if (keys[key] === 'openTime') {\n        obj[keys[key]] = formatDate(info[key]);\n      } else {\n        obj[keys[key]] = info[key];\n      }\n    });\n    dataList.push(obj);\n  }\n  // console.log(dataList)\n  /**\r\n   * [\r\n    {\r\n        \"username\": \"刘备\",\r\n        \"role\": \"管理员\",\r\n        \"openTime\": '2021-08-12',\r\n        \"password\": \"9079b6ee1d5ca04ab00e44e877a222ee\"\r\n    }\r\n  ]\r\n   */\n  await addUserBatch(dataList);\n}\n\n/**\r\n * 解析 excel 导入的时间格式\r\n */\nexport const formatDate = numb => {\n  const time = new Date((numb - 1) * 24 * 3600000 + 1);\n  time.setYear(time.getFullYear() - 70);\n  const year = time.getFullYear() + '';\n  const month = time.getMonth() + 1 + '';\n  const date = time.getDate() - 1 + '';\n  return year + '-' + (month < 10 ? '0' + month : month) + '-' + (date < 10 ? '0' + date : date);\n};","map":{"version":3,"names":["addUserBatch","keys","addUserByExcel","excelData","password","dataList","info","results","obj","Object","forEach","key","formatDate","push","numb","time","Date","setYear","getFullYear","year","month","getMonth","date","getDate"],"sources":["D:/myproject/毕业设计/pet-mall/apps/admin/src/views/Acl/User/components/AddUserDialog/hooks/addUserByExcel.js"],"sourcesContent":["import { addUserBatch } from '@/api/user-manage'\r\nimport { keys } from '../../../constant'\r\n\r\nexport default async function addUserByExcel(excelData, password) {\r\n  // console.log(excelData)\r\n  /**\r\n{\r\n  header: ['姓名', '角色', '开通时间'],\r\n  results: [\r\n    {\r\n      姓名: '刘备',\r\n      角色: '管理员',\r\n      开通时间: 44420\r\n    }\r\n  ]\r\n}\r\n   *\r\n   */\r\n  const dataList = []\r\n  for (const info of excelData.results) {\r\n    const obj = {\r\n      password\r\n    }\r\n    Object.keys(info).forEach((key) => {\r\n      if (keys[key] === 'openTime') {\r\n        obj[keys[key]] = formatDate(info[key])\r\n      } else {\r\n        obj[keys[key]] = info[key]\r\n      }\r\n    })\r\n    dataList.push(obj)\r\n  }\r\n  // console.log(dataList)\r\n  /**\r\n   * [\r\n    {\r\n        \"username\": \"刘备\",\r\n        \"role\": \"管理员\",\r\n        \"openTime\": '2021-08-12',\r\n        \"password\": \"9079b6ee1d5ca04ab00e44e877a222ee\"\r\n    }\r\n]\r\n   */\r\n  await addUserBatch(dataList)\r\n}\r\n\r\n/**\r\n * 解析 excel 导入的时间格式\r\n */\r\nexport const formatDate = (numb) => {\r\n  const time = new Date((numb - 1) * 24 * 3600000 + 1)\r\n  time.setYear(time.getFullYear() - 70)\r\n  const year = time.getFullYear() + ''\r\n  const month = time.getMonth() + 1 + ''\r\n  const date = time.getDate() - 1 + ''\r\n  return (\r\n    year +\r\n    '-' +\r\n    (month < 10 ? '0' + month : month) +\r\n    '-' +\r\n    (date < 10 ? '0' + date : date)\r\n  )\r\n}\r\n"],"mappings":";;;AAAA,SAASA,YAAY,QAAQ,mBAAmB;AAChD,SAASC,IAAI,QAAQ,mBAAmB;AAExC,eAAe,eAAeC,cAAcA,CAACC,SAAS,EAAEC,QAAQ,EAAE;EAChE;EACA;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACE,MAAMC,QAAQ,GAAG,EAAE;EACnB,KAAK,MAAMC,IAAI,IAAIH,SAAS,CAACI,OAAO,EAAE;IACpC,MAAMC,GAAG,GAAG;MACVJ;IACF,CAAC;IACDK,MAAM,CAACR,IAAI,CAACK,IAAI,CAAC,CAACI,OAAO,CAAEC,GAAG,IAAK;MACjC,IAAIV,IAAI,CAACU,GAAG,CAAC,KAAK,UAAU,EAAE;QAC5BH,GAAG,CAACP,IAAI,CAACU,GAAG,CAAC,CAAC,GAAGC,UAAU,CAACN,IAAI,CAACK,GAAG,CAAC,CAAC;MACxC,CAAC,MAAM;QACLH,GAAG,CAACP,IAAI,CAACU,GAAG,CAAC,CAAC,GAAGL,IAAI,CAACK,GAAG,CAAC;MAC5B;IACF,CAAC,CAAC;IACFN,QAAQ,CAACQ,IAAI,CAACL,GAAG,CAAC;EACpB;EACA;EACA;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACE,MAAMR,YAAY,CAACK,QAAQ,CAAC;AAC9B;;AAEA;AACA;AACA;AACA,OAAO,MAAMO,UAAU,GAAIE,IAAI,IAAK;EAClC,MAAMC,IAAI,GAAG,IAAIC,IAAI,CAAC,CAACF,IAAI,GAAG,CAAC,IAAI,EAAE,GAAG,OAAO,GAAG,CAAC,CAAC;EACpDC,IAAI,CAACE,OAAO,CAACF,IAAI,CAACG,WAAW,CAAC,CAAC,GAAG,EAAE,CAAC;EACrC,MAAMC,IAAI,GAAGJ,IAAI,CAACG,WAAW,CAAC,CAAC,GAAG,EAAE;EACpC,MAAME,KAAK,GAAGL,IAAI,CAACM,QAAQ,CAAC,CAAC,GAAG,CAAC,GAAG,EAAE;EACtC,MAAMC,IAAI,GAAGP,IAAI,CAACQ,OAAO,CAAC,CAAC,GAAG,CAAC,GAAG,EAAE;EACpC,OACEJ,IAAI,GACJ,GAAG,IACFC,KAAK,GAAG,EAAE,GAAG,GAAG,GAAGA,KAAK,GAAGA,KAAK,CAAC,GAClC,GAAG,IACFE,IAAI,GAAG,EAAE,GAAG,GAAG,GAAGA,IAAI,GAAGA,IAAI,CAAC;AAEnC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}